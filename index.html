<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ShiftTrack Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--p:#a78bfa;--p2:#8b5cf6;--p3:#c4b5fd;--p4:rgba(139,92,246,.12);
--acc:#fbbf24;--g:#34d399;--r:#f87171;--s:#38bdf8;
--bg:#0f0d1a;--bg2:#1a1726;--bg3:#231f33;--bg4:#2d2844;
--card:#1a1726;--card2:#231f33;
--glass:rgba(26,23,38,.88);
--t1:#f1f0f5;--t2:#9893a7;--t3:#5e5875;
--b1:#2d2844;--b2:#352f4a;
--rad:14px;--rad2:20px;
--sh1:0 2px 8px rgba(0,0,0,.3);
--sh2:0 8px 24px rgba(0,0,0,.4);
--sh3:0 16px 48px rgba(0,0,0,.5);
}
html{scroll-behavior:smooth}
body{font-family:'Plus Jakarta Sans',system-ui,sans-serif;background:var(--bg);color:var(--t1);min-height:100vh;overflow-x:hidden}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--p2);border-radius:10px}

/* LOGIN */
#loginScreen{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(160deg,#0a0812 0%,#1a1130 40%,#2d1b69 100%);position:relative;overflow:hidden}
#loginScreen::before{content:'';position:absolute;width:500px;height:500px;background:radial-gradient(circle,rgba(139,92,246,.15),transparent 70%);top:-150px;right:-80px;border-radius:50%;animation:p1 8s ease-in-out infinite}
#loginScreen::after{content:'';position:absolute;width:350px;height:350px;background:radial-gradient(circle,rgba(56,189,248,.1),transparent 70%);bottom:-80px;left:-40px;border-radius:50%;animation:p2 10s ease-in-out infinite}
@keyframes p1{0%,100%{transform:scale(1);opacity:.5}50%{transform:scale(1.3);opacity:.8}}
@keyframes p2{0%,100%{transform:scale(1.2);opacity:.4}50%{transform:scale(.9);opacity:.7}}
.login-container{position:relative;z-index:2;text-align:center;animation:rise .8s cubic-bezier(.16,1,.3,1)}
@keyframes rise{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:none}}
.login-brand{margin-bottom:44px}
.login-brand .icon{width:68px;height:68px;background:rgba(139,92,246,.2);border:1px solid rgba(139,92,246,.3);border-radius:20px;display:inline-flex;align-items:center;justify-content:center;font-size:30px;margin-bottom:14px;color:var(--p)}
.login-brand h1{font-size:34px;font-weight:900;color:#fff;letter-spacing:-.5px}
.login-brand p{color:rgba(255,255,255,.45);font-size:14px;margin-top:6px}
.login-cards{display:flex;gap:18px;flex-wrap:wrap;justify-content:center}
.login-card{width:200px;padding:32px 20px;border-radius:var(--rad2);background:rgba(255,255,255,.05);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.08);cursor:pointer;transition:all .35s cubic-bezier(.16,1,.3,1);color:#fff}
.login-card:hover{background:rgba(255,255,255,.1);border-color:rgba(139,92,246,.4);transform:translateY(-6px);box-shadow:0 16px 32px rgba(0,0,0,.3)}
.login-card .avatar{width:64px;height:64px;border-radius:50%;margin:0 auto 14px;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:800;background:linear-gradient(135deg,rgba(139,92,246,.3),rgba(56,189,248,.2));border:2px solid rgba(255,255,255,.15)}
.login-card h3{font-size:15px;font-weight:700;margin-bottom:3px}
.login-card span{font-size:11px;opacity:.4;font-weight:500}

/* APP */
#mainApp{display:none;min-height:100vh}
.topbar{position:fixed;top:0;left:0;right:0;height:56px;background:var(--glass);backdrop-filter:blur(20px);border-bottom:1px solid var(--b1);display:flex;align-items:center;padding:0 20px;z-index:100}
.topbar-brand{display:flex;align-items:center;gap:8px;font-size:16px;font-weight:800;color:var(--p)}
.topbar-brand .ico{width:32px;height:32px;background:linear-gradient(135deg,var(--p2),#6d28d9);border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px}
.topbar-right{margin-left:auto;display:flex;align-items:center;gap:10px}
.topbar-user{display:flex;align-items:center;gap:8px;padding:4px 12px 4px 4px;border-radius:50px;background:var(--p4)}
.topbar-user .av{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--p2),var(--s));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:11px}
.topbar-user span{font-size:12px;font-weight:600;color:var(--p3)}
.topbar-logout{width:32px;height:32px;border-radius:8px;border:1px solid var(--b1);background:transparent;cursor:pointer;color:var(--t3);font-size:13px;display:flex;align-items:center;justify-content:center;transition:all .2s}
.topbar-logout:hover{background:rgba(248,113,113,.1);color:var(--r);border-color:rgba(248,113,113,.3)}

/* NAV - B√úY√úK BUTONLAR */
.nav-tabs{position:fixed;top:56px;left:0;right:0;height:58px;background:var(--glass);backdrop-filter:blur(20px);border-bottom:1px solid var(--b1);display:flex;align-items:center;padding:0 16px;gap:6px;z-index:99;overflow-x:auto}
.nav-tab{padding:10px 22px;border-radius:50px;border:none;background:transparent;font-family:inherit;font-size:14px;font-weight:700;color:var(--t3);cursor:pointer;transition:all .25s;display:flex;align-items:center;gap:8px;white-space:nowrap;letter-spacing:-.2px}
.nav-tab:hover{background:var(--p4);color:var(--p)}
.nav-tab.active{background:var(--p2);color:#fff;box-shadow:0 2px 12px rgba(139,92,246,.35)}
.nav-tab i{font-size:15px}

.content{padding:130px 24px 36px;max-width:1200px;margin:0 auto}
.page{display:none;animation:pageIn .35s cubic-bezier(.16,1,.3,1)}
.page.active{display:block}
@keyframes pageIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}
.page-head{margin-bottom:24px}
.page-head h1{font-size:24px;font-weight:900;letter-spacing:-.3px}
.page-head p{color:var(--t2);font-size:13px;margin-top:3px;font-weight:500}

.card{background:var(--card);border-radius:var(--rad);padding:20px;box-shadow:var(--sh1);border:1px solid var(--b1);transition:box-shadow .3s}
.card:hover{box-shadow:var(--sh2)}
.card-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.card-head h3{font-size:14px;font-weight:700;display:flex;align-items:center;gap:7px}
.card-head h3 i{color:var(--p);font-size:14px}

.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-bottom:20px}
.stat{background:var(--card);border-radius:var(--rad);padding:16px;box-shadow:var(--sh1);border:1px solid var(--b1);transition:all .3s;position:relative;overflow:hidden}
.stat:hover{transform:translateY(-2px);box-shadow:var(--sh2)}
.stat .ribbon{position:absolute;top:0;left:0;right:0;height:2px}
.stat .ico{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:15px;margin-bottom:10px}
.stat .val{font-size:22px;font-weight:900;letter-spacing:-.5px}
.stat .lbl{font-size:11px;color:var(--t2);margin-top:3px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}
.c-violet .ribbon{background:linear-gradient(90deg,#8b5cf6,#a78bfa)}.c-violet .ico{background:rgba(139,92,246,.15);color:#a78bfa}
.c-amber .ribbon{background:linear-gradient(90deg,#f59e0b,#fbbf24)}.c-amber .ico{background:rgba(245,158,11,.15);color:#fbbf24}
.c-green .ribbon{background:linear-gradient(90deg,#10b981,#34d399)}.c-green .ico{background:rgba(16,185,129,.15);color:#34d399}
.c-red .ribbon{background:linear-gradient(90deg,#ef4444,#f87171)}.c-red .ico{background:rgba(239,68,68,.15);color:#f87171}
.c-cyan .ribbon{background:linear-gradient(90deg,#06b6d4,#22d3ee)}.c-cyan .ico{background:rgba(6,182,212,.15);color:#22d3ee}

.grid-2{display:grid;grid-template-columns:1.4fr 1fr;gap:16px}
.week-chart{display:flex;flex-direction:column;gap:10px}
.wk-row{display:flex;align-items:center;gap:10px}
.wk-row .label{min-width:50px;font-size:11px;font-weight:700;color:var(--t2)}
.wk-row .track{flex:1;height:24px;background:var(--bg3);border-radius:6px;overflow:hidden}
.wk-row .fill{height:100%;border-radius:6px;display:flex;align-items:center;padding-left:8px;font-size:10px;font-weight:700;color:#fff;transition:width .8s cubic-bezier(.16,1,.3,1)}
.wk-row .fill.ok{background:linear-gradient(90deg,#7c3aed,#a78bfa)}
.wk-row .fill.ot{background:linear-gradient(90deg,#f59e0b,#fbbf24)}
.wk-row .hrs{min-width:44px;text-align:right;font-size:12px;font-weight:800}
.info-list{display:flex;flex-direction:column}
.info-row{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--b1);font-size:13px}
.info-row:last-child{border:none}
.info-row .k{color:var(--t2);display:flex;align-items:center;gap:7px;font-weight:500}
.info-row .v{font-weight:700}.info-row .v.pos{color:var(--g)}.info-row .v.neg{color:var(--r)}.info-row .v.warn{color:var(--acc)}

/* CALENDAR */
.cal-controls{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px}
.cal-nav{display:flex;align-items:center;gap:6px}
.cal-nav-btn{width:36px;height:36px;border-radius:10px;border:1px solid var(--b1);background:var(--card);cursor:pointer;font-size:13px;color:var(--t1);transition:all .2s;display:flex;align-items:center;justify-content:center}
.cal-nav-btn:hover{background:var(--p2);color:#fff;border-color:var(--p2)}
.cal-month-title{font-size:18px;font-weight:800;min-width:180px;text-align:center}
.btn{padding:8px 16px;border-radius:10px;font-family:inherit;font-size:12px;font-weight:700;cursor:pointer;border:none;transition:all .25s;display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:var(--p2);color:#fff;box-shadow:0 3px 10px rgba(139,92,246,.3)}
.btn-primary:hover{background:#7c3aed;transform:translateY(-1px)}
.btn-soft{background:var(--p4);color:var(--p)}.btn-soft:hover{background:rgba(139,92,246,.2)}
.btn-outline{background:transparent;border:1.5px solid var(--b1);color:var(--t2)}
.btn-outline:hover{border-color:var(--p);color:var(--p);background:var(--p4)}
.btn-danger{background:transparent;border:1.5px solid rgba(248,113,113,.3);color:var(--r)}
.btn-danger:hover{background:var(--r);color:#fff}
.btn-ghost{background:none;border:1.5px solid var(--b1);color:var(--t2)}
.btn-ghost:hover{background:var(--bg3)}
.btn-sm{padding:5px 12px;font-size:11px;border-radius:7px}
.btn-xs{padding:3px 8px;font-size:10px;border-radius:5px}

.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
.cal-dname{text-align:center;font-size:10px;font-weight:700;color:var(--t3);padding:8px 0;text-transform:uppercase;letter-spacing:.8px}

.cal-cell{min-height:82px;border-radius:10px;padding:6px 7px;cursor:pointer;border:1.5px solid transparent;transition:all .2s;background:var(--card2);position:relative}
.cal-cell:hover{border-color:var(--p);box-shadow:var(--sh2);transform:translateY(-1px);z-index:2}
.cal-cell.out{opacity:.12;pointer-events:none}
.cal-cell.today{border-color:var(--p);background:rgba(139,92,246,.1)}
.cal-cell.holiday{background:rgba(248,113,113,.06);border-color:rgba(248,113,113,.12)}
.cal-cell.has-shift{background:rgba(52,211,153,.06);border-color:rgba(52,211,153,.1)}
/* ƒ∞zin t√ºrlerine g√∂re farklƒ± arka plan renkleri */
.cal-cell.leave-annual{background:rgba(96,165,250,.08);border-color:rgba(96,165,250,.2)}
.cal-cell.leave-weekly{background:rgba(139,92,246,.08);border-color:rgba(139,92,246,.2)}
.cal-cell.leave-sick{background:rgba(251,146,60,.08);border-color:rgba(251,146,60,.2)}
.cal-cell.leave-unpaid{background:rgba(148,163,184,.08);border-color:rgba(148,163,184,.2)}
.cal-cell .num{font-size:12px;font-weight:800;display:flex;justify-content:space-between;align-items:center;margin-bottom:3px}
.cal-cell .num small{font-weight:500;color:var(--t3);font-size:9px}

/* Saat g√∂stergesi */
.cal-cell .hrs-display{font-size:16px;font-weight:900;color:var(--g);line-height:1;margin:2px 0}
.cal-cell .hrs-display.overtime{color:var(--acc)}
.cal-cell .shift-time{font-size:9px;color:var(--t2);font-weight:600}

/* ƒ∞zin g√∂stergesi - belirgin */
.cal-cell .leave-display{margin-top:2px;display:flex;align-items:center;gap:4px;font-size:10px;font-weight:800;line-height:1.2}
.cal-cell .leave-display i{font-size:12px}
.cal-cell .leave-display.ld-annual{color:#60a5fa}
.cal-cell .leave-display.ld-weekly{color:var(--p)}
.cal-cell .leave-display.ld-sick{color:#fb923c}
.cal-cell .leave-display.ld-unpaid{color:#94a3b8}

.cal-cell .leave-label{font-size:9px;font-weight:700;padding:2px 6px;border-radius:4px;display:inline-block;margin-top:1px}
.cal-cell .leave-label.ll-annual{background:rgba(96,165,250,.15);color:#60a5fa}
.cal-cell .leave-label.ll-weekly{background:rgba(139,92,246,.15);color:var(--p)}
.cal-cell .leave-label.ll-sick{background:rgba(251,146,60,.15);color:#fb923c}
.cal-cell .leave-label.ll-unpaid{background:rgba(148,163,184,.15);color:#94a3b8}

/* Tatil etiketi */
.cal-cell .hol-tag{font-size:8px;font-weight:700;padding:2px 5px;border-radius:4px;background:rgba(248,113,113,.15);color:var(--r);display:inline-block;margin-top:1px}

.cal-legend{display:flex;gap:14px;margin-top:14px;flex-wrap:wrap}
.cal-legend span{display:flex;align-items:center;gap:5px;font-size:11px;font-weight:600;color:var(--t2)}
.cal-legend span i{font-size:8px}

.copy-bar{background:var(--p4);border:1px solid rgba(139,92,246,.25);border-radius:10px;padding:10px 14px;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between;font-size:12px;font-weight:600;color:var(--p3);animation:pageIn .3s ease}

/* MODAL */
.overlay{position:fixed;inset:0;background:rgba(10,8,18,.8);backdrop-filter:blur(8px);display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}
.overlay.show{display:flex}
.modal{background:var(--bg2);border-radius:var(--rad2);width:400px;max-width:100%;max-height:90vh;overflow-y:auto;box-shadow:var(--sh3);border:1px solid var(--b1);animation:modalPop .3s cubic-bezier(.16,1,.3,1)}
@keyframes modalPop{from{opacity:0;transform:scale(.94) translateY(10px)}to{opacity:1;transform:none}}
.modal-top{padding:16px 18px 0;display:flex;justify-content:space-between;align-items:center}
.modal-top h3{font-size:16px;font-weight:800}
.modal-top .date-badge{font-size:11px;color:var(--t2);font-weight:600;background:var(--bg3);padding:4px 10px;border-radius:6px}
.modal-x{width:30px;height:30px;border-radius:8px;border:1px solid var(--b1);background:none;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center;color:var(--t3);transition:all .2s}
.modal-x:hover{background:rgba(248,113,113,.1);color:var(--r);border-color:rgba(248,113,113,.3)}
.modal-body{padding:12px 18px}
.modal-foot{padding:0 18px 16px;display:flex;gap:8px;justify-content:flex-end}

.h-alert{background:rgba(248,113,113,.08);border:1px solid rgba(248,113,113,.2);border-radius:10px;padding:10px 12px;display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:11px;color:var(--r);font-weight:600}
.h-alert i{font-size:14px;flex-shrink:0}

.mode-tabs{display:flex;gap:4px;background:var(--bg);border-radius:10px;padding:3px;margin-bottom:12px}
.mode-tab{flex:1;padding:8px;border:none;background:none;border-radius:8px;font-family:inherit;font-size:12px;font-weight:700;cursor:pointer;color:var(--t3);transition:all .2s;display:flex;align-items:center;justify-content:center;gap:5px}
.mode-tab.active{background:var(--card2);color:var(--p);box-shadow:var(--sh1)}
.mode-tab:hover:not(.active){color:var(--t1)}

.preset-row{display:flex;gap:5px;margin-bottom:12px}
.preset{flex:1;padding:8px 4px;border-radius:8px;border:1.5px solid var(--b1);cursor:pointer;text-align:center;transition:all .2s;background:var(--card2)}
.preset:hover{border-color:var(--p);background:var(--p4)}
.preset.active{border-color:var(--p);background:var(--p4)}
.preset .p-icon{font-size:16px;display:block;margin-bottom:2px}
.preset .p-name{font-size:9px;font-weight:700;color:var(--t1);display:block}
.preset .p-time{font-size:8px;color:var(--t3);font-weight:600;display:block;margin-top:1px}

.time-inputs{display:flex;gap:6px;margin-bottom:10px;align-items:end}
.time-inputs .ti{flex:1}
.time-inputs .ti label{display:block;font-size:9px;font-weight:700;color:var(--t3);margin-bottom:3px;text-transform:uppercase;letter-spacing:.3px}
input[type="time"],input[type="text"],input[type="number"],input[type="date"],select{width:100%;padding:8px 8px;border:1.5px solid var(--b1);border-radius:8px;font-family:inherit;font-size:13px;font-weight:600;transition:all .2s;background:var(--bg3);color:var(--t1)}
input:focus,select:focus{outline:none;border-color:var(--p);box-shadow:0 0 0 3px rgba(139,92,246,.15)}
input[type="time"]{font-size:14px;font-weight:800;text-align:center;padding:7px 4px}

.result-box{background:var(--bg);border-radius:10px;padding:10px;display:flex;justify-content:space-between;align-items:center;border:1px solid var(--b1)}
.result-box .rb-item{text-align:center;flex:1}
.result-box .rb-val{font-size:16px;font-weight:900;color:var(--p)}
.result-box .rb-val.accent{color:var(--acc)}
.result-box .rb-val.green{color:var(--g)}
.result-box .rb-lbl{font-size:8px;font-weight:600;color:var(--t3);text-transform:uppercase;letter-spacing:.2px;margin-top:1px}
.result-box .rb-div{width:1px;height:28px;background:var(--b1)}

.lt-row{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:10px}
.lt-opt{padding:12px 6px;border-radius:10px;border:1.5px solid var(--b1);cursor:pointer;text-align:center;font-size:11px;font-weight:700;transition:all .2s;color:var(--t2);background:var(--card2)}
.lt-opt:hover{border-color:var(--p);background:var(--p4)}
.lt-opt.active{border-color:var(--p);background:var(--p4);color:var(--p)}
.lt-opt i{display:block;font-size:18px;margin-bottom:4px}
.lt-opt small{display:block;font-size:8px;color:var(--t3);font-weight:500;margin-top:2px}
.fg{margin-bottom:10px}
.fg label{display:block;font-size:9px;font-weight:700;color:var(--t3);margin-bottom:3px;text-transform:uppercase;letter-spacing:.3px}

/* LEAVES */
.leave-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-bottom:20px}
.leave-c{padding:18px}
.leave-c h4{font-size:12px;font-weight:700;margin-bottom:12px;display:flex;align-items:center;gap:7px;color:var(--t2)}
.leave-c .big{font-size:26px;font-weight:900;letter-spacing:-.5px}
.leave-c .big small{font-size:13px;font-weight:600;color:var(--t3)}
.pbar{height:5px;background:var(--bg3);border-radius:3px;overflow:hidden;margin:10px 0 6px}
.pbar .pf{height:100%;border-radius:3px;transition:width .7s cubic-bezier(.16,1,.3,1)}
.leave-c .meta{display:flex;justify-content:space-between;font-size:10px;font-weight:600;color:var(--t3)}
table{width:100%;border-collapse:separate;border-spacing:0}
th{text-align:left;padding:8px 12px;font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;border-bottom:1.5px solid var(--b1)}
td{padding:10px 12px;font-size:12px;font-weight:500;border-bottom:1px solid var(--b1)}
tr:hover td{background:var(--bg3)}
.tag{padding:3px 8px;border-radius:20px;font-size:9px;font-weight:700}
.tag-a{background:rgba(96,165,250,.15);color:#60a5fa}
.tag-s{background:rgba(251,146,60,.15);color:#fb923c}
.tag-w{background:rgba(139,92,246,.15);color:var(--p)}
.tag-u{background:rgba(148,163,184,.15);color:#94a3b8}

/* EARNINGS */
.earn-hero{background:linear-gradient(135deg,#1a1036 0%,#2d1b69 50%,#4c1d95 100%);color:#fff;border-radius:var(--rad2);padding:28px;position:relative;overflow:hidden;border:1px solid rgba(139,92,246,.2)}
.earn-hero::before{content:'‚Ç∫';position:absolute;right:20px;bottom:-16px;font-size:100px;font-weight:900;opacity:.05}
.earn-hero .sub{font-size:12px;opacity:.5;font-weight:600}
.earn-hero .amt{font-size:34px;font-weight:900;margin:6px 0}
.earn-hero .info{font-size:12px;opacity:.4;font-weight:500}
.earn-row{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--b1);font-size:13px}
.earn-row:last-child{border:none;padding-top:14px;border-top:1.5px solid var(--b2);font-size:15px}
.earn-row .k{color:var(--t2);display:flex;align-items:center;gap:7px;font-weight:500}
.earn-row .k i{width:18px;text-align:center;font-size:14px}
.earn-row .v{font-weight:700}.earn-row .v.plus{color:var(--g)}.earn-row .v.minus{color:var(--r)}

/* SETTINGS */
.s-card{max-width:580px;margin-bottom:16px}
.s-card h3{font-size:14px;font-weight:800;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--b1);display:flex;align-items:center;gap:8px}
.s-card h3 i{color:var(--p);font-size:14px}
.salary-preview{background:var(--bg3);border:1px solid var(--b1);border-radius:12px;padding:20px;margin-top:14px;text-align:center}
.salary-preview .amt{font-size:30px;font-weight:900;color:var(--p)}
.salary-preview .det{font-size:12px;color:var(--t2);margin-top:4px;font-weight:600}
.hint{background:var(--p4);border:1px solid rgba(139,92,246,.15);border-radius:10px;padding:12px 14px;font-size:12px;color:var(--p3);display:flex;align-items:start;gap:8px;margin-bottom:14px;font-weight:500;line-height:1.5}
.hint i{margin-top:1px;font-size:13px;flex-shrink:0}
.data-btns{display:flex;gap:8px;flex-wrap:wrap}
.empty{text-align:center;padding:36px 16px;color:var(--t3)}
.empty i{font-size:36px;margin-bottom:10px;opacity:.2}
.empty p{font-size:13px;font-weight:600}

@media(max-width:768px){
.content{padding:126px 12px 28px}.grid-2{grid-template-columns:1fr}
.stats{grid-template-columns:repeat(2,1fr)}
.cal-cell{min-height:56px;padding:4px 5px}
.cal-cell .shift-time,.cal-cell .leave-label,.cal-cell .hol-tag{display:none}
.earn-hero .amt{font-size:24px}
.nav-tab span{display:none}.nav-tab{padding:8px 14px}
.login-cards{flex-direction:column;align-items:center}
}
@media(max-width:480px){
.stats{grid-template-columns:1fr}
.lt-row{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div id="loginScreen">
<div class="login-container">
<div class="login-brand"><div class="icon"><i class="fas fa-clock"></i></div>
<h1>ShiftTrack Pro</h1><p>Akƒ±llƒ± Vardiya & Kazan√ß Y√∂netimi</p></div>
<div class="login-cards">
<div class="login-card" onclick="login(1)"><div class="avatar" id="la1">1</div><h3 id="ln1">Kullanƒ±cƒ± 1</h3><span>Giri≈ü yap ‚Üí</span></div>
<div class="login-card" onclick="login(2)"><div class="avatar" id="la2">2</div><h3 id="ln2">Kullanƒ±cƒ± 2</h3><span>Giri≈ü yap ‚Üí</span></div>
</div></div></div>

<div id="mainApp">
<header class="topbar">
<div class="topbar-brand"><div class="ico"><i class="fas fa-clock"></i></div>ShiftTrack</div>
<div class="topbar-right">
<div class="topbar-user"><div class="av" id="topAv">U</div><span id="topName">Kullanƒ±cƒ±</span></div>
<button class="topbar-logout" onclick="logout()" title="√áƒ±kƒ±≈ü"><i class="fas fa-sign-out-alt"></i></button>
</div></header>
<nav class="nav-tabs">
<button class="nav-tab active" onclick="go('dashboard',this)"><i class="fas fa-th-large"></i><span>Panel</span></button>
<button class="nav-tab" onclick="go('calendar',this)"><i class="fas fa-calendar-alt"></i><span>Takvim</span></button>
<button class="nav-tab" onclick="go('leaves',this)"><i class="fas fa-umbrella-beach"></i><span>ƒ∞zinler</span></button>
<button class="nav-tab" onclick="go('earnings',this)"><i class="fas fa-wallet"></i><span>Kazan√ß</span></button>
<button class="nav-tab" onclick="go('settings',this)"><i class="fas fa-cog"></i><span>Ayarlar</span></button>
</nav>
<main class="content">

<div class="page active" id="pg-dashboard">
<div class="page-head"><h1>Kontrol Paneli</h1><p id="dashSub"></p></div>
<div class="stats" id="statsEl"></div>
<div class="grid-2">
<div class="card"><div class="card-head"><h3><i class="fas fa-chart-bar"></i>Haftalƒ±k Saatler</h3></div><div class="week-chart" id="weekChart"></div></div>
<div class="card"><div class="card-head"><h3><i class="fas fa-info-circle"></i>√ñzet</h3></div><div class="info-list" id="dashInfo"></div></div>
</div></div>

<div class="page" id="pg-calendar">
<div class="page-head"><h1>Vardiya Takvimi</h1><p>G√ºne tƒ±klayarak giri≈ü yapƒ±n</p></div>
<div id="copyBar"></div>
<div class="card">
<div class="cal-controls">
<div class="cal-nav">
<button class="cal-nav-btn" onclick="chgM(-1)"><i class="fas fa-chevron-left"></i></button>
<span class="cal-month-title" id="calTitle"></span>
<button class="cal-nav-btn" onclick="chgM(1)"><i class="fas fa-chevron-right"></i></button>
</div>
<button class="btn btn-soft btn-sm" onclick="goToday()"><i class="fas fa-crosshairs"></i>Bug√ºn</button>
</div>
<div class="cal-grid" id="calGrid"></div>
<div class="cal-legend">
<span><i class="fas fa-circle" style="color:var(--p)"></i>Bug√ºn</span>
<span><i class="fas fa-circle" style="color:var(--g)"></i>Vardiya</span>
<span><i class="fas fa-circle" style="color:var(--r)"></i>Tatil</span>
<span><i class="fas fa-circle" style="color:#60a5fa"></i>Y.ƒ∞zin</span>
<span><i class="fas fa-circle" style="color:#fb923c"></i>Rapor</span>
<span><i class="fas fa-circle" style="color:var(--p)"></i>H.Tatil</span>
</div></div></div>

<div class="page" id="pg-leaves">
<div class="page-head"><h1>ƒ∞zin Y√∂netimi</h1><p>ƒ∞zin haklarƒ±nƒ±z</p></div>
<div class="leave-cards" id="leaveCards"></div>
<div class="card"><div class="card-head"><h3><i class="fas fa-history"></i>Ge√ßmi≈ü ‚Äî <span id="leaveYr"></span></h3></div><div id="leaveTable"></div></div></div>

<div class="page" id="pg-earnings">
<div class="page-head"><h1>Kazan√ß Raporu</h1><p>Aylƒ±k gelir detaylarƒ±</p></div>
<div class="cal-controls" style="margin-bottom:16px"><div class="cal-nav">
<button class="cal-nav-btn" onclick="chgE(-1)"><i class="fas fa-chevron-left"></i></button>
<span class="cal-month-title" id="earnTitle"></span>
<button class="cal-nav-btn" onclick="chgE(1)"><i class="fas fa-chevron-right"></i></button>
</div></div><div id="earnContent"></div></div>

<div class="page" id="pg-settings">
<div class="page-head"><h1>Ayarlar</h1><p>Ki≈üisel bilgiler ve maa≈ü</p></div>
<div class="card s-card"><h3><i class="fas fa-user"></i>Ki≈üisel Bilgiler</h3>
<div class="fg"><label>Ad Soyad</label><input type="text" id="sName" placeholder="Adƒ±nƒ±z" onchange="sSet('name',this.value)"></div>
<div class="fg"><label>ƒ∞≈üe Ba≈ülama</label><input type="date" id="sStart" onchange="sSet('startDate',this.value)"></div></div>
<div class="card s-card"><h3><i class="fas fa-money-bill-wave"></i>Maa≈ü</h3>
<div class="hint"><i class="fas fa-lightbulb"></i><span>Net maa≈ü girin. Saatlik=Net√∑225. FM √ó1.5, Tatil √ó1 ek.</span></div>
<div class="fg"><label>Aylƒ±k Net (‚Ç∫)</label><input type="number" id="sSalary" placeholder="25000" min="0" step="100" onchange="sSet('netSalary',this.value)"></div>
<div class="salary-preview" id="salPrev" style="display:none"><div class="amt" id="salAmt">‚Ç∫0</div><div class="det" id="salDet"></div></div></div>
<div class="card s-card"><h3><i class="fas fa-calendar-check"></i>Yƒ±llƒ±k ƒ∞zin</h3>
<div class="hint"><i class="fas fa-balance-scale"></i><span>1‚Äì5yƒ±l‚Üí14g, 5‚Äì15‚Üí20g, 15+‚Üí26g</span></div>
<div class="fg"><label>ƒ∞zin Hakkƒ± (g√ºn)</label><input type="number" id="sLeave" placeholder="14" min="0" max="40" onchange="sSet('annualLeave',this.value)"></div></div>
<div class="card s-card"><h3><i class="fas fa-database"></i>Veri</h3>
<div class="data-btns">
<button class="btn btn-outline" onclick="exportD()"><i class="fas fa-download"></i>Yedekle</button>
<button class="btn btn-outline" onclick="document.getElementById('impF').click()"><i class="fas fa-upload"></i>Y√ºkle</button>
<input type="file" id="impF" style="display:none" accept=".json" onchange="importD(event)">
<button class="btn btn-danger" onclick="clearD()"><i class="fas fa-trash"></i>Sƒ±fƒ±rla</button></div></div>
</div>
</main></div>

<!-- MODAL -->
<div class="overlay" id="modal">
<div class="modal">
<div class="modal-top">
<div style="display:flex;align-items:center;gap:8px">
<h3 id="mTitle">16</h3>
<span class="date-badge" id="mDate">Pazartesi</span>
</div>
<button class="modal-x" onclick="closeM()"><i class="fas fa-times"></i></button>
</div>
<div class="modal-body">
<div id="mAlert" class="h-alert" style="display:none"><i class="fas fa-flag"></i><span id="mAlertTx"></span></div>

<div class="mode-tabs">
<button class="mode-tab active" onclick="mMode('shift',this)"><i class="fas fa-clock"></i>Vardiya</button>
<button class="mode-tab" onclick="mMode('leave',this)"><i class="fas fa-umbrella-beach"></i>ƒ∞zin</button>
</div>

<div id="mShift">
<div class="preset-row">
<div class="preset" data-key="morning" onclick="applyPreset('morning',this)"><span class="p-icon">üåÖ</span><span class="p-name">Sabah</span><span class="p-time">08‚Äì16</span></div>
<div class="preset" data-key="afternoon" onclick="applyPreset('afternoon',this)"><span class="p-icon">üåá</span><span class="p-name">√ñƒülen</span><span class="p-time">12‚Äì20</span></div>
<div class="preset" data-key="evening" onclick="applyPreset('evening',this)"><span class="p-icon">üåô</span><span class="p-name">Ak≈üam</span><span class="p-time">16‚Äì00</span></div>
<div class="preset" data-key="custom" onclick="applyPreset('custom',this)"><span class="p-icon">‚öôÔ∏è</span><span class="p-name">√ñzel</span><span class="p-time">Serbest</span></div>
</div>
<div class="time-inputs">
<div class="ti"><label>Giri≈ü</label><input type="time" id="iStart" value="08:00"></div>
<div class="ti"><label>√áƒ±kƒ±≈ü</label><input type="time" id="iEnd" value="16:00"></div>
<div class="ti"><label>Mola</label>
<select id="iBreak"><option value="0">Yok</option><option value="15">15dk</option><option value="30" selected>30dk</option><option value="45">45dk</option><option value="60">1s</option><option value="90">1.5s</option></select></div>
</div>
<div class="result-box">
<div class="rb-item"><div class="rb-val" id="rbGross">8s</div><div class="rb-lbl">Br√ºt</div></div>
<div class="rb-div"></div>
<div class="rb-item"><div class="rb-val accent" id="rbBreak">30dk</div><div class="rb-lbl">Mola</div></div>
<div class="rb-div"></div>
<div class="rb-item"><div class="rb-val green" id="rbNet">7.5s</div><div class="rb-lbl">Net</div></div>
<div class="rb-div"></div>
<div class="rb-item"><div class="rb-val" id="rbOT" style="color:var(--t3)">‚Äî</div><div class="rb-lbl">F.Mesai</div></div>
</div>
</div>

<div id="mLeave" style="display:none">
<div class="lt-row">
<div class="lt-opt" data-t="annual" onclick="selLT('annual',this)"><i class="fas fa-umbrella-beach" style="color:#60a5fa"></i>Yƒ±llƒ±k ƒ∞zin<small>√úcretli</small></div>
<div class="lt-opt" data-t="weekly" onclick="selLT('weekly',this)"><i class="fas fa-couch" style="color:var(--p)"></i>Hafta Tatili<small>Dinlenme</small></div>
<div class="lt-opt" data-t="sick" onclick="selLT('sick',this)"><i class="fas fa-notes-medical" style="color:#fb923c"></i>Rapor<small>Hastalƒ±k</small></div>
<div class="lt-opt" data-t="unpaid" onclick="selLT('unpaid',this)"><i class="fas fa-ban" style="color:var(--r)"></i>√úcretsiz<small>Kesinti</small></div>
</div>
<div class="fg"><label>Not</label><input type="text" id="iNote" placeholder="Opsiyonel..."></div>
</div>
</div>
<div class="modal-foot">
<button class="btn btn-outline btn-sm" id="mCopy" onclick="copyShift()" style="display:none;margin-right:auto"><i class="fas fa-copy"></i></button>
<button class="btn btn-danger btn-sm" id="mDel" onclick="delEntry()" style="display:none"><i class="fas fa-trash"></i></button>
<button class="btn btn-ghost btn-sm" onclick="closeM()">ƒ∞ptal</button>
<button class="btn btn-primary btn-sm" onclick="saveEntry()"><i class="fas fa-check"></i>Kaydet</button>
</div></div></div>

<script>
const MTR=['Ocak','≈ûubat','Mart','Nisan','Mayƒ±s','Haziran','Temmuz','Aƒüustos','Eyl√ºl','Ekim','Kasƒ±m','Aralƒ±k'];
const DTR=['Pzt','Sal','√áar','Per','Cum','Cmt','Paz'];
const DFL=['Pazartesi','Salƒ±','√áar≈üamba','Per≈üembe','Cuma','Cumartesi','Pazar'];
const MH=225;
const PRESETS={
  morning:{start:'08:00',end:'16:00',break:30},
  afternoon:{start:'12:00',end:'20:00',break:30},
  evening:{start:'16:00',end:'00:00',break:30},
  custom:null
};
const FH=[{m:1,d:1,n:'Yƒ±lba≈üƒ±'},{m:4,d:23,n:'23 Nisan'},{m:5,d:1,n:'1 Mayƒ±s'},{m:5,d:19,n:'19 Mayƒ±s'},{m:7,d:15,n:'15 Temmuz'},{m:8,d:30,n:'30 Aƒüustos'},{m:10,d:29,n:'29 Ekim'}];
const RH={
2024:[{m:4,d:10,n:'Ramazan B.'},{m:4,d:11,n:'Ramazan B.'},{m:4,d:12,n:'Ramazan B.'},{m:6,d:17,n:'Kurban B.'},{m:6,d:18,n:'Kurban B.'},{m:6,d:19,n:'Kurban B.'},{m:6,d:20,n:'Kurban B.'}],
2025:[{m:3,d:30,n:'Ramazan B.'},{m:3,d:31,n:'Ramazan B.'},{m:4,d:1,n:'Ramazan B.'},{m:6,d:6,n:'Kurban B.'},{m:6,d:7,n:'Kurban B.'},{m:6,d:8,n:'Kurban B.'},{m:6,d:9,n:'Kurban B.'}],
2026:[{m:3,d:20,n:'Ramazan B.'},{m:3,d:21,n:'Ramazan B.'},{m:3,d:22,n:'Ramazan B.'},{m:5,d:27,n:'Kurban B.'},{m:5,d:28,n:'Kurban B.'},{m:5,d:29,n:'Kurban B.'},{m:5,d:30,n:'Kurban B.'}],
2027:[{m:3,d:9,n:'Ramazan B.'},{m:3,d:10,n:'Ramazan B.'},{m:3,d:11,n:'Ramazan B.'},{m:5,d:16,n:'Kurban B.'},{m:5,d:17,n:'Kurban B.'},{m:5,d:18,n:'Kurban B.'},{m:5,d:19,n:'Kurban B.'}]};

let S={cu:null,cm:new Date().getMonth(),cy:new Date().getFullYear(),em:new Date().getMonth(),ey:new Date().getFullYear(),sd:null,mt:'shift',lt:null,clipboard:null,
u:{1:{name:'Kullanƒ±cƒ± 1',netSalary:0,startDate:'',annualLeave:14,shifts:{},leaves:{}},
   2:{name:'Kullanƒ±cƒ± 2',netSalary:0,startDate:'',annualLeave:14,shifts:{},leaves:{}}}};

function init(){
  loadLS();
  updLogin();
  document.getElementById('iStart').addEventListener('input',updResult);
  document.getElementById('iEnd').addEventListener('input',updResult);
  document.getElementById('iBreak').addEventListener('change',updResult);
}

function updLogin(){
  [1,2].forEach(i=>{
    const u=S.u[i];
    document.getElementById('ln'+i).textContent=u.name||'Kullanƒ±cƒ± '+i;
    document.getElementById('la'+i).textContent=(u.name||'K')[0].toUpperCase();
  });
}

function login(id){
  S.cu=id;
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('mainApp').style.display='block';
  updTop();
  renderAll();
}

function logout(){
  S.cu=null;
  document.getElementById('mainApp').style.display='none';
  document.getElementById('loginScreen').style.display='flex';
  updLogin();
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  document.querySelector('.nav-tab').classList.add('active');
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById('pg-dashboard').classList.add('active');
}

function updTop(){
  const u=cu();
  document.getElementById('topName').textContent=u.name||'ƒ∞simsiz';
  document.getElementById('topAv').textContent=(u.name||'K')[0].toUpperCase();
}

function cu(){return S.u[S.cu];}

function go(p,btn){
  document.querySelectorAll('.page').forEach(x=>x.classList.remove('active'));
  document.getElementById('pg-'+p).classList.add('active');
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  if(btn) btn.classList.add('active');
  renderAll();
}

function renderAll(){
  renderDash();
  renderCal();
  renderLeaves();
  renderEarn();
  loadSet();
}

// === HOLIDAYS ===
function getH(ds){
  const d=new Date(ds);
  const y=d.getFullYear(), m=d.getMonth()+1, day=d.getDate();
  for(const h of FH){
    if(h.m===m && h.d===day) return h.n;
  }
  const r=RH[y];
  if(r){
    for(const h of r){
      if(h.m===m && h.d===day) return h.n;
    }
  }
  return null;
}
function isH(ds){return getH(ds)!==null;}

// === CALCULATIONS ===
function calcHr(s,e,b){
  const[sh,sm]=s.split(':').map(Number);
  const[eh,em]=e.split(':').map(Number);
  let st=sh*60+sm, en=eh*60+em;
  if(en<=st) en+=1440;
  return Math.max(0,(en-st-b)/60);
}

function grossHr(s,e){
  const[sh,sm]=s.split(':').map(Number);
  const[eh,em]=e.split(':').map(Number);
  let st=sh*60+sm, en=eh*60+em;
  if(en<=st) en+=1440;
  return Math.max(0,(en-st)/60);
}

function getISOWeek(d){
  const dt=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate()));
  const dn=dt.getUTCDay()||7;
  dt.setUTCDate(dt.getUTCDate()+4-dn);
  const ys=new Date(Date.UTC(dt.getUTCFullYear(),0,1));
  return dt.getUTCFullYear()+'-W'+String(Math.ceil((((dt-ys)/864e5)+1)/7)).padStart(2,'0');
}

function dStr(d){
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

function fm(n){
  if(n===undefined||n===null||isNaN(n)||n===0) return '‚Ç∫0';
  return '‚Ç∫'+n.toLocaleString('tr-TR',{minimumFractionDigits:0,maximumFractionDigits:2});
}

// === MONTH DATA ===
function getMD(y,m){
  const u=cu();
  if(!u) return {};
  const dim=new Date(y,m+1,0).getDate();
  let th=0, oh=0, hh=0, wd=0, hdw=0;
  const wh={};

  for(let d=1; d<=dim; d++){
    const s=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const sh=u.shifts[s];
    if(!sh) continue;
    const hrs=calcHr(sh.start,sh.end,sh.break);
    if(hrs<=0) continue;
    th+=hrs;
    wd++;
    const dt=new Date(y,m,d);
    const wk=getISOWeek(dt);
    if(!wh[wk]) wh[wk]=0;
    wh[wk]+=hrs;
    if(isH(s)){hh+=hrs;hdw++;}
  }

  // Fazla mesai: haftalƒ±k 45 saat √ºzeri
  let rh=0;
  oh=0;
  Object.values(wh).forEach(w=>{
    if(w>45){oh+=w-45;rh+=45;}
    else rh+=w;
  });

  // ƒ∞zinler
  let yau=0, ysd=0, wr=0, ud=0;
  Object.entries(u.leaves).forEach(([k,v])=>{
    const ld=new Date(k);
    if(ld.getFullYear()===y){
      if(v.type==='annual') yau++;
      if(v.type==='sick') ysd++;
    }
    if(ld.getFullYear()===y && ld.getMonth()===m){
      if(v.type==='weekly') wr++;
      if(v.type==='unpaid') ud++;
    }
  });

  const hr=u.netSalary>0 ? u.netSalary/MH : 0;
  const bs=u.netSalary;
  const op=oh*hr*1.5;
  const hp=hh*hr;
  const upd=ud*(u.netSalary/30);
  const te=bs+op+hp-upd;

  return {th,rh,oh,hh,wd,hdw,wh,wr,ud,yau,ysd,hr,bs,op,hp,upd,te,dim};
}

// === DASHBOARD ===
function renderDash(){
  const u=cu();
  if(!u) return;
  const d=getMD(S.cy,S.cm);
  document.getElementById('dashSub').textContent=`${MTR[S.cm]} ${S.cy} ‚Äî ${u.name}`;

  document.getElementById('statsEl').innerHTML=`
    <div class="stat c-violet"><div class="ribbon"></div><div class="ico"><i class="fas fa-clock"></i></div><div class="val">${d.th.toFixed(1)}</div><div class="lbl">Toplam Saat</div></div>
    <div class="stat c-amber"><div class="ribbon"></div><div class="ico"><i class="fas fa-fire"></i></div><div class="val">${d.oh.toFixed(1)}</div><div class="lbl">Fazla Mesai</div></div>
    <div class="stat c-green"><div class="ribbon"></div><div class="ico"><i class="fas fa-wallet"></i></div><div class="val">${u.netSalary?fm(d.te):'‚Äî'}</div><div class="lbl">Kazan√ß</div></div>
    <div class="stat c-red"><div class="ribbon"></div><div class="ico"><i class="fas fa-flag"></i></div><div class="val">${d.hdw}</div><div class="lbl">Tatil √áalƒ±≈üma</div></div>
    <div class="stat c-cyan"><div class="ribbon"></div><div class="ico"><i class="fas fa-calendar-check"></i></div><div class="val">${d.wd}</div><div class="lbl">√áalƒ±≈üƒ±lan G√ºn</div></div>`;

  const wks=Object.entries(d.wh).sort((a,b)=>a[0].localeCompare(b[0]));
  let wc='';
  if(!wks.length){
    wc='<div class="empty"><i class="fas fa-calendar-times"></i><p>Vardiya yok</p></div>';
  } else {
    wks.forEach(([,h],i)=>{
      const p=Math.min(100,h/60*100);
      wc+=`<div class="wk-row"><span class="label">${i+1}. Hafta</span><div class="track"><div class="fill ${h>45?'ot':'ok'}" style="width:${p}%">${h.toFixed(1)}s</div></div><span class="hrs" style="color:${h>45?'var(--acc)':'var(--t1)'}">${h.toFixed(1)}</span></div>`;
    });
  }
  document.getElementById('weekChart').innerHTML=wc;

  const al=u.annualLeave||14, ar=al-d.yau;
  let info='';
  if(!u.netSalary) info='<div class="hint" style="margin-bottom:8px"><i class="fas fa-exclamation-triangle"></i><span>Ayarlar\'dan maa≈ü girin.</span></div>';
  info+=`
    <div class="info-row"><span class="k"><i class="fas fa-umbrella-beach"></i>Kalan Y.ƒ∞zin</span><span class="v ${ar<=3?'neg':''}">${ar}g</span></div>
    <div class="info-row"><span class="k"><i class="fas fa-notes-medical"></i>Rapor</span><span class="v">${d.ysd}g</span></div>
    <div class="info-row"><span class="k"><i class="fas fa-coins"></i>Saatlik</span><span class="v">${u.netSalary?fm(d.hr):'‚Äî'}</span></div>
    <div class="info-row"><span class="k"><i class="fas fa-fire"></i>FM √úcreti</span><span class="v pos">${u.netSalary?fm(d.op):'‚Äî'}</span></div>
    <div class="info-row"><span class="k"><i class="fas fa-flag"></i>Tatil √úcreti</span><span class="v pos">${u.netSalary?fm(d.hp):'‚Äî'}</span></div>`;
  document.getElementById('dashInfo').innerHTML=info;
}

// === CALENDAR ===
function renderCal(){
  const y=S.cy, m=S.cm;
  document.getElementById('calTitle').textContent=MTR[m]+' '+y;
  const g=document.getElementById('calGrid');
  g.innerHTML='';

  DTR.forEach(d=>{
    const e=document.createElement('div');
    e.className='cal-dname';
    e.textContent=d;
    g.appendChild(e);
  });

  const fd=new Date(y,m,1);
  let sd2=fd.getDay();
  sd2=sd2===0?6:sd2-1;
  const dim=new Date(y,m+1,0).getDate();
  const pip=new Date(y,m,0).getDate();
  const td=dStr(new Date());
  const u=cu();

  // √ñnceki ay
  for(let i=sd2-1;i>=0;i--){
    const e=document.createElement('div');
    e.className='cal-cell out';
    e.innerHTML=`<div class="num">${pip-i}</div>`;
    g.appendChild(e);
  }

  // Bu ay
  for(let d=1;d<=dim;d++){
    const s=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const e=document.createElement('div');
    let c='cal-cell';
    if(s===td) c+=' today';

    const hol=getH(s);
    const sh=u.shifts[s];
    const lv=u.leaves[s];
    const dow=new Date(y,m,d).getDay();
    const dn=DTR[dow===0?6:dow-1];

    // Renklendirme √∂ncelik: shift > leave > holiday
    if(sh){
      c+=' has-shift';
    } else if(lv){
      c+=' leave-'+lv.type;
    } else if(hol){
      c+=' holiday';
    }

    let inner=`<div class="num"><span>${d}</span><small>${dn}</small></div>`;

    // Vardiya giri≈üi varsa: saat g√∂ster
    if(sh){
      const h=calcHr(sh.start,sh.end,sh.break);
      inner+=`<div class="hrs-display ${h>7.5?'overtime':''}">${h.toFixed(1)}s</div>`;
      inner+=`<div class="shift-time">${sh.start}‚Äì${sh.end}</div>`;
      if(hol){
        inner+=`<span class="hol-tag">üèõÔ∏è Tatil</span>`;
      }
    }
    // ƒ∞zin giri≈üi varsa: ikon + yazƒ± + renk
    else if(lv){
      const icons={annual:'fa-umbrella-beach',weekly:'fa-couch',sick:'fa-notes-medical',unpaid:'fa-ban'};
      const labels={annual:'Yƒ±llƒ±k ƒ∞zin',weekly:'Hafta Tatili',sick:'Rapor',unpaid:'√úcretsiz ƒ∞zin'};
      inner+=`<div class="leave-display ld-${lv.type}"><i class="fas ${icons[lv.type]}"></i>${labels[lv.type].split(' ')[0]}</div>`;
      inner+=`<span class="leave-label ll-${lv.type}">${labels[lv.type]}</span>`;
      if(hol){
        inner+=`<span class="hol-tag">${hol}</span>`;
      }
    }
    // Sadece tatil
    else if(hol){
      inner+=`<span class="hol-tag">${hol}</span>`;
    }

    e.className=c;
    e.innerHTML=inner;
    e.onclick=()=>openM(s);
    g.appendChild(e);
  }

  // Sonraki ay
  const tot=sd2+dim;
  const rem=tot%7===0?0:7-(tot%7);
  for(let i=1;i<=rem;i++){
    const e=document.createElement('div');
    e.className='cal-cell out';
    e.innerHTML=`<div class="num">${i}</div>`;
    g.appendChild(e);
  }
  renderCopyBar();
}

function chgM(d){
  S.cm+=d;
  if(S.cm>11){S.cm=0;S.cy++;}
  if(S.cm<0){S.cm=11;S.cy--;}
  renderCal();
  renderDash();
}

function goToday(){
  S.cm=new Date().getMonth();
  S.cy=new Date().getFullYear();
  renderCal();
  renderDash();
}

// === COPY/PASTE ===
function copyShift(){
  const sh=cu().shifts[S.sd];
  if(sh){S.clipboard={...sh};renderCopyBar();closeM();}
}

function pasteShift(ds){
  if(!S.clipboard) return;
  const u=cu();
  u.shifts[ds]={...S.clipboard};
  delete u.leaves[ds];
  saveLS();
  renderAll();
}

function clearClipboard(){S.clipboard=null;renderCopyBar();}

function renderCopyBar(){
  const el=document.getElementById('copyBar');
  if(S.clipboard){
    const h=calcHr(S.clipboard.start,S.clipboard.end,S.clipboard.break);
    el.innerHTML=`<div class="copy-bar"><span><i class="fas fa-clipboard"></i> ${S.clipboard.start}‚Äì${S.clipboard.end} (${h.toFixed(1)}s) ‚Äî G√ºne tƒ±klayƒ±n</span><button class="btn btn-soft btn-xs" onclick="clearClipboard()"><i class="fas fa-times"></i></button></div>`;
  } else {
    el.innerHTML='';
  }
}

// === MODAL ===
function openM(ds){
  if(S.clipboard){pasteShift(ds);return;}

  S.sd=ds;
  const d=new Date(ds);
  const dow=d.getDay();
  const dn=DFL[dow===0?6:dow-1];

  document.getElementById('mTitle').textContent=d.getDate()+' '+MTR[d.getMonth()];
  document.getElementById('mDate').textContent=dn;

  const hol=getH(ds);
  const al=document.getElementById('mAlert');
  if(hol){
    al.style.display='flex';
    document.getElementById('mAlertTx').textContent=`${hol} ‚Äî Ek √ºcret hesaplanƒ±r`;
  } else {
    al.style.display='none';
  }

  const u=cu();
  const sh=u.shifts[ds];
  const lv=u.leaves[ds];

  // Reset
  mMode('shift',document.querySelectorAll('.mode-tab')[0]);
  S.lt=null;
  document.querySelectorAll('.lt-opt').forEach(o=>o.classList.remove('active'));
  document.getElementById('iNote').value='';
  document.querySelectorAll('.preset').forEach(p=>p.classList.remove('active'));

  if(sh){
    document.getElementById('iStart').value=sh.start;
    document.getElementById('iEnd').value=sh.end;
    document.getElementById('iBreak').value=String(sh.break);
    document.getElementById('mDel').style.display='inline-flex';
    document.getElementById('mCopy').style.display='inline-flex';
    hlPreset(sh);
  } else if(lv){
    mMode('leave',document.querySelectorAll('.mode-tab')[1]);
    const el=document.querySelector(`.lt-opt[data-t="${lv.type}"]`);
    if(el) selLT(lv.type,el);
    document.getElementById('iNote').value=lv.note||'';
    document.getElementById('mDel').style.display='inline-flex';
    document.getElementById('mCopy').style.display='none';
  } else {
    document.getElementById('iStart').value='08:00';
    document.getElementById('iEnd').value='16:00';
    document.getElementById('iBreak').value='30';
    document.getElementById('mDel').style.display='none';
    document.getElementById('mCopy').style.display='none';
    applyPreset('morning',document.querySelector('.preset[data-key="morning"]'));
  }

  updResult();
  document.getElementById('modal').classList.add('show');
}

function hlPreset(sh){
  document.querySelectorAll('.preset').forEach(p=>p.classList.remove('active'));
  for(const[k,v]of Object.entries(PRESETS)){
    if(!v) continue;
    if(v.start===sh.start && v.end===sh.end && v.break===sh.break){
      const el=document.querySelector(`.preset[data-key="${k}"]`);
      if(el) el.classList.add('active');
      return;
    }
  }
  document.querySelector('.preset[data-key="custom"]').classList.add('active');
}

function closeM(){document.getElementById('modal').classList.remove('show');}

function mMode(t,btn){
  S.mt=t;
  document.querySelectorAll('.mode-tab').forEach(b=>b.classList.remove('active'));
  if(btn) btn.classList.add('active');
  document.getElementById('mShift').style.display=t==='shift'?'block':'none';
  document.getElementById('mLeave').style.display=t==='leave'?'block':'none';
}

function selLT(t,el){
  S.lt=t;
  document.querySelectorAll('.lt-opt').forEach(o=>o.classList.remove('active'));
  if(el) el.classList.add('active');
}

function applyPreset(key,el){
  document.querySelectorAll('.preset').forEach(p=>p.classList.remove('active'));
  if(el) el.classList.add('active');
  if(key!=='custom' && PRESETS[key]){
    document.getElementById('iStart').value=PRESETS[key].start;
    document.getElementById('iEnd').value=PRESETS[key].end;
    document.getElementById('iBreak').value=String(PRESETS[key].break);
  }
  updResult();
}

function updResult(){
  const s=document.getElementById('iStart').value;
  const e=document.getElementById('iEnd').value;
  const b=parseInt(document.getElementById('iBreak').value)||0;
  if(!s||!e) return;

  const net=calcHr(s,e,b);
  const gross=grossHr(s,e);

  document.getElementById('rbGross').textContent=gross.toFixed(1)+'s';
  document.getElementById('rbBreak').textContent=b+'dk';
  document.getElementById('rbNet').textContent=net.toFixed(1)+'s';

  const ot=net>7.5?net-7.5:0;
  document.getElementById('rbOT').textContent=ot>0?'+'+ot.toFixed(1)+'s':'‚Äî';
  document.getElementById('rbOT').style.color=ot>0?'var(--acc)':'var(--t3)';
}

function saveEntry(){
  const u=cu();
  const s=S.sd;

  if(S.mt==='shift'){
    const st=document.getElementById('iStart').value;
    const en=document.getElementById('iEnd').value;
    const br=parseInt(document.getElementById('iBreak').value)||0;
    if(!st||!en){alert('Saatleri girin.');return;}
    const hrs=calcHr(st,en,br);
    if(hrs<=0){alert('Ge√ßersiz saat aralƒ±ƒüƒ±.');return;}
    u.shifts[s]={start:st,end:en,break:br};
    delete u.leaves[s];
  } else {
    if(!S.lt){alert('ƒ∞zin t√ºr√º se√ßin.');return;}
    u.leaves[s]={type:S.lt,note:document.getElementById('iNote').value};
    delete u.shifts[s];
  }

  saveLS();
  closeM();
  renderAll();
}

function delEntry(){
  const u=cu();
  if(u.shifts[S.sd]) delete u.shifts[S.sd];
  if(u.leaves[S.sd]) delete u.leaves[S.sd];
  saveLS();
  closeM();
  renderAll();
}

document.getElementById('modal').addEventListener('click',function(e){if(e.target===this)closeM();});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeM();});

// === LEAVES ===
function renderLeaves(){
  const u=cu();
  const y=S.cy;
  const d=getMD(y,S.cm);
  const at=u.annualLeave||14;
  const ar=at-d.yau;

  document.getElementById('leaveYr').textContent=y;

  document.getElementById('leaveCards').innerHTML=`
    <div class="card leave-c"><h4><i class="fas fa-umbrella-beach" style="color:#60a5fa"></i>Yƒ±llƒ±k ƒ∞zin</h4><div class="big" style="color:#60a5fa">${ar} <small>/ ${at}g</small></div><div class="pbar"><div class="pf" style="width:${Math.min(100,(d.yau/Math.max(at,1))*100)}%;background:linear-gradient(90deg,#3b82f6,#60a5fa)"></div></div><div class="meta"><span>Kullanƒ±lan: ${d.yau}</span><span>Kalan: ${ar}</span></div></div>
    <div class="card leave-c"><h4><i class="fas fa-notes-medical" style="color:#fb923c"></i>Rapor</h4><div class="big" style="color:#fb923c">${d.ysd} <small>g√ºn</small></div><div class="pbar"><div class="pf" style="width:${Math.min(100,d.ysd/20*100)}%;background:linear-gradient(90deg,#f59e0b,#fbbf24)"></div></div><div class="meta"><span>Bu yƒ±l</span><span>${d.ysd}g</span></div></div>
    <div class="card leave-c"><h4><i class="fas fa-couch" style="color:var(--p)"></i>Hafta Tatili</h4><div class="big" style="color:var(--p)">${d.wr} <small>g√ºn</small></div><div class="pbar"><div class="pf" style="width:${Math.min(100,d.wr/5*100)}%;background:linear-gradient(90deg,#8b5cf6,#a78bfa)"></div></div><div class="meta"><span>${MTR[S.cm]}</span><span>${d.wr}g</span></div></div>
    <div class="card leave-c"><h4><i class="fas fa-ban" style="color:var(--r)"></i>√úcretsiz</h4><div class="big" style="color:var(--r)">${d.ud} <small>g√ºn</small></div><div class="pbar"><div class="pf" style="width:${Math.min(100,d.ud/5*100)}%;background:linear-gradient(90deg,#ef4444,#f87171)"></div></div><div class="meta"><span>Kesinti</span><span>${u.netSalary?fm(d.upd):'‚Äî'}</span></div></div>`;

  const all=Object.entries(u.leaves).filter(([k])=>new Date(k).getFullYear()===y).sort((a,b)=>b[0].localeCompare(a[0]));
  if(!all.length){
    document.getElementById('leaveTable').innerHTML='<div class="empty"><i class="fas fa-check-circle"></i><p>Kayƒ±t yok</p></div>';
    return;
  }

  const tl={annual:'Yƒ±llƒ±k',weekly:'H.Tatil',sick:'Rapor',unpaid:'√úcretsiz'};
  const tc={annual:'a',weekly:'w',sick:'s',unpaid:'u'};
  let t='<table><thead><tr><th>Tarih</th><th>G√ºn</th><th>T√ºr</th><th>Not</th><th></th></tr></thead><tbody>';
  all.forEach(([k,v])=>{
    const dd=new Date(k);
    const dow=dd.getDay();
    t+=`<tr><td>${dd.getDate()} ${MTR[dd.getMonth()]}</td><td>${DFL[dow===0?6:dow-1]}</td><td><span class="tag tag-${tc[v.type]}">${tl[v.type]}</span></td><td>${v.note||'‚Äî'}</td><td><button class="btn btn-danger btn-xs" onclick="delLv('${k}')"><i class="fas fa-trash"></i></button></td></tr>`;
  });
  t+='</tbody></table>';
  document.getElementById('leaveTable').innerHTML=t;
}

function delLv(k){
  if(confirm('Sil?')){
    delete cu().leaves[k];
    saveLS();
    renderAll();
  }
}

// === EARNINGS ===
function renderEarn(){
  const u=cu();
  const y=S.ey, m=S.em;
  document.getElementById('earnTitle').textContent=MTR[m]+' '+y;
  const d=getMD(y,m);

  if(!u.netSalary){
    document.getElementById('earnContent').innerHTML='<div class="hint"><i class="fas fa-exclamation-triangle"></i><span>Ayarlar\'dan maa≈ü girin.</span></div>';
    return;
  }

  document.getElementById('earnContent').innerHTML=`
    <div class="earn-hero"><div class="sub">TAHMƒ∞Nƒ∞ KAZAN√á</div><div class="amt">${fm(d.te)}</div><div class="info">${MTR[m]} ${y} ‚Ä¢ ${d.wd}g ‚Ä¢ ${d.th.toFixed(1)}s</div></div>
    <div class="card" style="margin-top:16px"><div class="card-head"><h3><i class="fas fa-receipt"></i>Detay</h3></div>
    <div class="earn-row"><span class="k"><i class="fas fa-money-bill" style="color:var(--p)"></i>Baz Maa≈ü</span><span class="v">${fm(d.bs)}</span></div>
    <div class="earn-row"><span class="k"><i class="fas fa-fire" style="color:var(--acc)"></i>FM (${d.oh.toFixed(1)}s √ó ${fm(d.hr)} √ó 1.5)</span><span class="v plus">+${fm(d.op)}</span></div>
    <div class="earn-row"><span class="k"><i class="fas fa-flag" style="color:var(--r)"></i>Tatil (${d.hh.toFixed(1)}s ek)</span><span class="v plus">+${fm(d.hp)}</span></div>
    <div class="earn-row"><span class="k"><i class="fas fa-minus-circle" style="color:var(--r)"></i>√ú.ƒ∞zin (${d.ud}g)</span><span class="v minus">-${fm(d.upd)}</span></div>
    <div class="earn-row"><span class="k"><i class="fas fa-calculator" style="color:var(--p)"></i><b>TOPLAM</b></span><span class="v" style="font-size:16px;color:var(--p)">${fm(d.te)}</span></div></div>
    <div class="card" style="margin-top:16px"><div class="card-head"><h3><i class="fas fa-chart-pie"></i>Saatler</h3></div>
    <div class="info-list">
    <div class="info-row"><span class="k">Toplam</span><span class="v">${d.th.toFixed(1)}s</span></div>
    <div class="info-row"><span class="k">Normal</span><span class="v">${d.rh.toFixed(1)}s</span></div>
    <div class="info-row"><span class="k">Fazla Mesai</span><span class="v warn">${d.oh.toFixed(1)}s</span></div>
    <div class="info-row"><span class="k">Tatil</span><span class="v">${d.hh.toFixed(1)}s (${d.hdw}g)</span></div></div></div>`;
}

function chgE(d){
  S.em+=d;
  if(S.em>11){S.em=0;S.ey++;}
  if(S.em<0){S.em=11;S.ey--;}
  renderEarn();
}

// === SETTINGS ===
function loadSet(){
  const u=cu();
  if(!u) return;
  document.getElementById('sName').value=u.name||'';
  document.getElementById('sSalary').value=u.netSalary||'';
  document.getElementById('sStart').value=u.startDate||'';
  document.getElementById('sLeave').value=u.annualLeave||14;
  updSal();
}

function sSet(k,v){
  const u=cu();
  if(k==='netSalary') v=parseFloat(v)||0;
  if(k==='annualLeave') v=parseInt(v)||14;
  u[k]=v;

  if(k==='startDate' && v){
    const s=new Date(v);
    const n=new Date();
    const yr=(n-s)/(365.25*864e5);
    let l=14;
    if(yr>=15) l=26;
    else if(yr>=5) l=20;
    u.annualLeave=l;
    document.getElementById('sLeave').value=l;
  }

  saveLS();
  updTop();
  updSal();
  renderAll();
}

function updSal(){
  const u=cu();
  const el=document.getElementById('salPrev');
  if(u.netSalary>0){
    el.style.display='block';
    document.getElementById('salAmt').textContent=fm(u.netSalary);
    document.getElementById('salDet').textContent=`Saatlik: ${fm(u.netSalary/MH)} | G√ºnl√ºk: ${fm(u.netSalary/30)}`;
  } else {
    el.style.display='none';
  }
}

// === DATA ===
function saveLS(){localStorage.setItem('st_data',JSON.stringify(S.u));}

function loadLS(){
  const s=localStorage.getItem('st_data');
  if(s){
    try{
      const p=JSON.parse(s);
      if(p[1]) S.u[1]={...S.u[1],...p[1]};
      if(p[2]) S.u[2]={...S.u[2],...p[2]};
    } catch(e){
      console.error('Veri y√ºkleme hatasƒ±:',e);
    }
  }
}

function exportD(){
  const b=new Blob([JSON.stringify(S.u,null,2)],{type:'application/json'});
  const u=URL.createObjectURL(b);
  const a=document.createElement('a');
  a.href=u;
  a.download=`shifttrack_${dStr(new Date())}.json`;
  a.click();
  URL.revokeObjectURL(u);
}

function importD(e){
  const f=e.target.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=function(ev){
    try{
      const p=JSON.parse(ev.target.result);
      if(p[1]) S.u[1]={...S.u[1],...p[1]};
      if(p[2]) S.u[2]={...S.u[2],...p[2]};
      saveLS();
      renderAll();
      updTop();
      alert('Y√ºklendi!');
    } catch(err){
      alert('Ge√ßersiz dosya.');
    }
  };
  r.readAsText(f);
  e.target.value='';
}

function clearD(){
  if(confirm('T√ºm veriler silinecek?')){
    S.u[S.cu]={name:'Kullanƒ±cƒ± '+S.cu,netSalary:0,startDate:'',annualLeave:14,shifts:{},leaves:{}};
    saveLS();
    renderAll();
    updTop();
    loadSet();
  }
}

init();
</script>
</body>
</html>
